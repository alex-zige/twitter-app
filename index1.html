<!DOCTYPE html>
<html>

<head>

	<title>Your Twitter unfollowers </title>
	<meta charset='utf-8'>

</head>

<body>

<input  width='120px' id="twitter_username" type="text" value="Please put your twitter username"/>
<input id="check" type="button" value="start search"/>
<div id="content-pane"></div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<script src="http://ajax.cdnjs.com/ajax/libs/underscore.js/1.1.4/underscore-min.js"></script>
<script src="http://ajax.cdnjs.com/ajax/libs/backbone.js/0.3.3/backbone-min.js"></script>

<script type="text/javascript">

(function ($) {

	var SearchView = Backbone.View.extend({

		el:$('body'),
		events:{
		'focus input#twitter_username' : 'focusin',
		'blur input#twitter_username' : 'blur',
 		'click input#check': 'check'
		},

	 initialize: function(){
      _.bindAll(this, 'render', 'check'); // every function that uses 'this' as the current object should be in here
      this.counter = 0; // total number of items added thus far
      this.render(); 
    },
      render: function(){

    },  
    check: function(){

    	twitter_name = $('#twitter_username').val();

		//passing value to controller;
		this.loadRestfulData("http://twitter.dev/dev/api/twitter/"+twitter_name);

    },	
    loadRestfulData: function(api){

			//Set the content pane to a loading screen
			$("#content-pane").text( "fetching your data..." );

			//Load the data in using jQuerys ajax call
			$.ajax({
				url: api,
				dataType: "json",
				success: function(data){

					if (data!== null){

					//Once we receive the data, set it to the content pane.
					//console.log(data.length);

					$("#content-pane").text( "Your Latest unfollowers are :" );

						for (var i = 0; i < data.length; i++) {
					
						var html = "<li><a href='http://twitter.com/#!/"+data[i].screen_name+"' target='_blank'><img src="+data[i].profile_image_url+" /><storng>"+data[i].name+"</strong><p>"+data[i].description+"</p></li><br/>";

						$("#content-pane").append(html);

						}
						
					}else{
					
						var html="You are lucky, you have no unfollowers these between your lastest check.";
						$("#content-pane").text(html);

					};

				}
			});	
		},

		focusin:function(el){

			if(el.target.value != ""){

			$("#twitter_username").val("");

			}

 	},
 	blur:function(el){

			if(el.target.value == ""){

			$("#twitter_username").val(el.target.defaultValue);

				}


 	},
	});

 	var SearchView = new SearchView();      


})(jQuery);

</script>
</body>
</html>

